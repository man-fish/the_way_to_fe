## æ˜ å°„ç±»å‹

### `in` æ“ä½œç¬¦

æ¥çœ‹çœ‹æœ€ç®€å•çš„æ˜ å°„ç±»å‹å’Œå®ƒçš„ç»„æˆéƒ¨åˆ†ï¼š

```ts
type Keys = 'option1' | 'option2';
type Flags = { [K in Keys]: boolean };
```

`Keys` ç›¸å½“äºæ˜¯ç”¨ `keyof` æå–å‡ºæ¥çš„ä¸€ä¸ªç´¢å¼•æŸ¥è¯¢ç±»å‹ï¼Œä¸‹é¢çš„ `{ [K in Keys]: boolean };` ä¸­ `in` éå† `Keys`ï¼š

1. ç´¢å¼•ç±»å‹ä¼šä¾æ¬¡ç»‘å®šç”Ÿæˆå¤šä¸ªå±æ€§ï¼ˆ`Keys` é‡Œé¢åŒ…å«äº†å±æ€§åï¼‰ã€‚
2. å¹¶ä¸”å¯¹æ¯ä¸€ä¸ªå±æ€§åè®¾ç½®ä¸€ä¸ªå¯¹åº”çš„ç±»å‹ï¼ˆ`boolean`ï¼‰ã€‚

åœ¨ä¸ªç®€å•çš„ä¾‹å­é‡Œï¼Œ `Keys`æ˜¯ç¡¬ç¼–ç çš„çš„å±æ€§ååˆ—è¡¨å¹¶ä¸”å±æ€§ç±»å‹æ°¸è¿œæ˜¯ `boolean`ï¼Œå› æ­¤è¿™ä¸ªæ˜ å°„ç±»å‹ç­‰åŒäºï¼š

```ts
type Flags = {
    option1: boolean;
    option2: boolean;
}
```

### æ˜ å°„ä¿®é¥°ç¬¦

å­˜åœ¨å¯ä»¥æ˜ å°„æœŸé—´æ–½åŠ ä¸¤ä¸ªé™„åŠ æ”¹æ€§å‰‚ï¼š`readonly`å’Œ`?`å½±å“åˆ†åˆ«æ˜“å˜æ€§å’Œå¯é€‰æ€§ã€‚

æ‚¨å¯ä»¥é€šè¿‡æ·»åŠ å‰ç¼€`-`æˆ–æ¥åˆ é™¤æˆ–æ·»åŠ è¿™äº›ä¿®é¥°ç¬¦`+`ã€‚å¦‚æœä¸æ·»åŠ å‰ç¼€ï¼Œåˆ™å‡å®šä¸º`+`ã€‚

```ts
// Removes 'readonly' attributes from a type's properties
type CreateMutable<Type> = {
  -readonly [Property in keyof Type]: Type[Property];
};

type LockedAccount = {
  readonly id: string;
  readonly name: string;
};

type UnlockedAccount = CreateMutable<LockedAccount>;
//   ^ = type UnlockedAccount = {
//       id: string;
//       name: string;
//   }
```

å†æ¥ä¸ª `-` çš„ï¼š

```ts
// Removes 'optional' attributes from a type's properties
type Concrete<Type> = {
  [Property in keyof Type]-?: Type[Property];
};

type MaybeUser = {
  id: string;
  name?: string;
  age?: number;
};

type User = Concrete<MaybeUser>;
//   ^ = type User = {
//       id: string;
//       name: string;
//       age: number;
//   }
```

### å¯†é’¥é‡æ–°æ˜ å°„é€šè¿‡ `as`

åœ¨TypeScript 4.1åŠæ›´é«˜ç‰ˆæœ¬ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ˜ å°„ç±»å‹çš„`as`å­å¥é‡æ–°æ˜ å°„æ˜ å°„ç±»å‹ä¸­çš„é”®ï¼š

```
type MappedTypeWithNewProperties<Type> = {
    [Properties in keyof Type as NewKeyType]: Type[Properties]
}
```

æ‚¨å¯ä»¥åˆ©ç”¨[æ¨¡æ¿æ–‡å­—ç±»å‹ä¹‹ç±»çš„](https://www.typescriptlang.org/docs/handbook/2/template-literal-types.html)åŠŸèƒ½ä»å…ˆå‰çš„å±æ€§åç§°åˆ›å»ºæ–°çš„å±æ€§åç§°ï¼š

```
type Getters<Type> = {
    [Property in keyof Type as `get${Capitalize<string & Property>}`]: () => Type[Property]
};

interface Person {
    name: string;
    age: number;
    location: string;
}

type LazyPerson = Getters<Person>;//   ^ = type LazyPerson = {
//       getName: () => string;
//       getAge: () => number;
//       getLocation: () => string;
//   }å°è¯•
```

æ‚¨å¯ä»¥`never`é€šè¿‡æ¡ä»¶ç±»å‹äº§ç”Ÿé”®æ¥è¿‡æ»¤æ‰é”®ï¼š

```
// Remove the 'kind' property
type RemoveKindField<T> = {
    [K in keyof T as Exclude<K, "kind">]: T[K]
};

interface Circle {
    kind: "circle";
    radius: number;
}

type KindlessCircle = RemoveKindField<Circle>;//   ^ = type KindlessCircle = {
//       radius: number;
//   }
```

### ä¸€ä¸ªæ —å­ğŸŒ°

ä¸€ä¸ªå¸¸è§çš„ä»»åŠ¡æ˜¯å°†ä¸€ä¸ªå·²çŸ¥çš„ç±»å‹æ¯ä¸ªå±æ€§éƒ½å˜ä¸ºå¯é€‰çš„ï¼š

```ts
interface PersonPartial {
    name?: string;
    age?: number;
}
```

æˆ–è€…æˆ‘ä»¬æƒ³è¦ä¸€ä¸ªåªè¯»ç‰ˆæœ¬ï¼š

```ts
interface PersonReadonly {
    readonly name: string;
    readonly age: number;
}
```

è¿™åœ¨JavaScripté‡Œç»å¸¸å‡ºç°ï¼ŒTypeScriptæä¾›äº†ä»æ—§ç±»å‹ä¸­åˆ›å»ºæ–°ç±»å‹çš„ä¸€ç§æ–¹å¼ â€” **æ˜ å°„ç±»å‹**ã€‚ åœ¨æ˜ å°„ç±»å‹é‡Œï¼Œæ–°ç±»å‹ä»¥ç›¸åŒçš„å½¢å¼å»è½¬æ¢æ—§ç±»å‹é‡Œæ¯ä¸ªå±æ€§ã€‚ ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä»¤æ¯ä¸ªå±æ€§æˆä¸º `readonly`ç±»å‹æˆ–å¯é€‰çš„ã€‚ ä¸‹é¢æ˜¯ä¸€äº›ä¾‹å­ï¼š

```ts
type Readonly<T> = {
    readonly [P in keyof T]: T[P];
}
type Partial<T> = {
    [P in keyof T]?: T[P];
}
```

åƒä¸‹é¢è¿™æ ·ä½¿ç”¨ï¼š

```ts
type PersonPartial = Partial<Person>;
type ReadonlyPerson = Readonly<Person>;
```

é™¤äº†è¿™ä¸¤ä¸ªä¹‹å¤–è¿˜æœ‰ä¸€äº›å…¶ä»–çš„å¥½ç”¨çš„æ“ä½œå‡½æ•°ï¼š

```ts
type Nullable<T> = { [P in keyof T]: T[P] | null }
```

åœ¨è¿™äº›ä¾‹å­é‡Œï¼Œå±æ€§åˆ—è¡¨æ˜¯ `keyof T`ä¸”ç»“æœç±»å‹æ˜¯ `T[P]`æˆ–æ˜¯å…¶å˜ä½“ã€‚è¿™æ˜¯ä½¿ç”¨é€šç”¨æ˜ å°„ç±»å‹çš„ä¸€ä¸ªå¥½æ¨¡ç‰ˆã€‚ å› ä¸ºè¿™ç±»è½¬æ¢æ˜¯ [åŒæ€](https://en.wikipedia.org/wiki/Homomorphism)çš„ï¼Œæ˜ å°„åªä½œç”¨äº `T`çš„å±æ€§è€Œæ²¡æœ‰å…¶å®ƒçš„ã€‚ 

 ç¼–è¯‘å™¨çŸ¥é“åœ¨æ·»åŠ ä»»ä½•æ–°å±æ€§ä¹‹å‰å¯ä»¥æ‹·è´æ‰€æœ‰å­˜åœ¨çš„å±æ€§ä¿®é¥°ç¬¦ã€‚ ä¾‹å¦‚ï¼Œå‡è®¾ `Person.name`æ˜¯åªè¯»çš„ï¼Œé‚£ä¹ˆ `Partial<Person>.name`ä¹Ÿå°†æ˜¯åªè¯»çš„ä¸”ä¸ºå¯é€‰çš„ã€‚

```ts
type Record<K extends string, T> = {
    [P in K]: T;
}
```

`Readonly`ï¼Œ `Partial`å’Œ `Pick`æ˜¯åŒæ€çš„ï¼Œä½† `Record`ä¸æ˜¯ã€‚ å› ä¸º `Record`å¹¶ä¸éœ€è¦è¾“å…¥ç±»å‹æ¥æ‹·è´å±æ€§ï¼Œæ‰€ä»¥å®ƒä¸å±äºåŒæ€ï¼š

```ts
type ThreeStringProps = Record<'prop1' | 'prop2' | 'prop3', string>
```

éåŒæ€ç±»å‹æœ¬è´¨ä¸Šä¼šåˆ›å»ºæ–°çš„å±æ€§ï¼Œå› æ­¤å®ƒä»¬ä¸ä¼šä»å®ƒå¤„æ‹·è´å±æ€§ä¿®é¥°ç¬¦ã€‚

### è¿›ä¸€æ­¥æ¢ç´¢

æ˜ å°„ç±»å‹ä¸æ­¤ç±»å‹æ“ä½œéƒ¨åˆ†ä¸­çš„å…¶ä»–åŠŸèƒ½é…åˆè‰¯å¥½ï¼š

```ts
type NonNull<Type> = {
  [Property in keyof Type]: Type[Property] extends null ? never : Type[Property];
};
```