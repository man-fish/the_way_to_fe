# ResponseğŸŒ…

`http.Response`ä¸€ä¸ª`http`å“åº”æµå¤„ç†åŒ…ï¼Œä¸»è¦åˆ†ä¸º`func HandleFunc (w http.ResponseWriter,r *http.Request)`å’Œ`func get/Post/clien.Do(url, contentType string, body io.Reader) (resp *Response, err error)`ä¸­çš„`ResponseWriter`å’Œ`Response`ï¼Œä¸€ä¸ªè´Ÿè´£è§£æå“åº”æµï¼Œä¸€ä¸ªè´Ÿè´£è¿”å›å“åº”æµã€‚

## ResponseğŸ—»

### ç»“æ„ä½“

```go
type Response struct {
	Status     string 
	StatusCode int    
	Proto      string
	Header Header
	Body io.ReadCloser
	ContentLength int64
}
```

#### Statusã€StatusCodeã€Proto

è¿™æ²¡ä»€ä¹ˆå¥½è¯´çš„åœ¨è¯·æ±‚è¿”å›çš„å“åº”æµä¸­ç”¨äºè§£ææ•°æ®

```go
Status      // e.g. "200 OK"
StatusCode  // e.g. 200
Proto       // e.g. "HTTP/1.0"
```

#### Header

`Header`å­—æ®µæ˜¯ä¸€ä¸ªmapç±»å‹ï¼Œåœ¨å“åº”æµä¸­è´Ÿè´£è§£æè¿”å›çš„å“åº”å¤´ã€‚

```go
type Header map[string][]string

func (h Header) Add(key, value string) {
	textproto.MIMEHeader(h).Add(key, value)
}

func (h Header) Set(key, value string) {
	textproto.MIMEHeader(h).Set(key, value)
}

func (h Header) Get(key string) string {
	return textproto.MIMEHeader(h).Get(key)
}

func (h Header) Del(key string) {
	textproto.MIMEHeader(h).Del(key)
}
```

#### Bodyã€ContentLength

ç”¨äºè§£æè¿”å›çš„æ•°æ®ï¼Œæ˜¯`io.Reader`æ¥å£çš„å®ç°è€…ã€‚

```go
func main() {
	url := "http://127.0.0.1:3000/postData?id=1"
	resp, err := http.Post(url,contentType,nil)

	if err != nil {
		panic(err)
	}
	defer resp.Body.Close()
	b, err := ioutil.ReadAll(resp.Body)
	//è§£æè¯·æ±‚ä½“
	fmt.Println(string(b))
}
```

### æ¥æ”¶è€…æ–¹æ³•

#### io.Writerçš„Writeæ–¹æ³•

```go
func (r *Response) Write(w io.Writer) error {}
```

#### Cookieç›¸å…³æ–¹æ³•

```go
func (r *Response) Cookies() []*Cookie {
	return readSetCookies(r.Header)
}
```

## ResponseWriterğŸŒ„

å¯¹äº`ResponseWriter`æ¥è¯´ä¸éœ€è¦æœ‰å¤ªå¤šèŠ±é‡Œèƒ¡å“¨çš„åŠŸèƒ½ï¼Œèƒ½å†™è¯·æ±‚ä½“å’Œè¯·æ±‚å¤´è¿˜æœ‰çŠ¶æ€ç å°±è¡Œäº†ã€‚

```go
type ResponseWriter interface {
	Header() Header
	Write([]byte) (int, error)
	WriteHeader(statusCode int)
}
```

### Header

è¿”å›`ResponseWriter`å®ç°è€…çš„`Header`å­—æ®µï¼ˆmapå¤©ç”Ÿå°±æ˜¯å¼•ç”¨å­—æ®µï¼‰ï¼Œä¹‹åå¯ä»¥è°ƒç”¨Headerçš„æ¥æ”¶è€…æ–¹æ³•è®¾ç½®è¯·æ±‚å¤´ã€‚

```go
func sayHello(w http.ResponseWriter,r *http.Request) {
	w.Header().Add("Set-Cookie","name=1")
    w.Header().Add("Content-Type","text/html")
	defer fmt.Fprintf(w,"hello server run by GO %q!!",html.EscapeString(r.URL.Path))
}

func main () {
	http.HandleFunc("/",sayHello)
	err := http.ListenAndServe(":3000",nil)
	if err != nil {
		fmt.Println(err)
		return
	}
}
```

### Writeã€WriteHeader

æˆ‘ä»¬åªéœ€è¦è°ƒç”¨[`Write`]()æ–¹æ³•å‘å“åº”ä¸­å†™å…¥æ•°æ®å°±è¡Œäº†ã€‚

```go
func sayHello(w http.ResponseWriter,r *http.Request) {
    w.WriteHeader(200)//é»˜è®¤ä¸¤ç™¾
	defer fmt.Fprint(w,"hello server run by GO !!")
}

func main () {
	http.HandleFunc("/",sayHello)
	err := http.ListenAndServe(":3000",nil)
	if err != nil {
		fmt.Println(err)
		return
	}
}
```

