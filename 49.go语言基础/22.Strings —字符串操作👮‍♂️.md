# Strings å­—ç¬¦ä¸²æ“ä½œğŸ‘®â€â™‚ï¸

## åŸºç¡€å‡½æ•°ğŸ§šâ€â™‚ï¸

### æ˜¯å¦å­˜åœ¨æŸä¸ªå­ä¸²ContainsğŸ‘¨â€âœˆï¸

æœ‰ä¸‰ä¸ªå‡½æ•°åšè¿™ä»¶äº‹ï¼š

```go
// å­ä¸² substr åœ¨ s ä¸­ï¼Œè¿”å› true
func Contains(s, substr string) bool
// chars ä¸­ä»»ä½•ä¸€ä¸ª Unicode ä»£ç ç‚¹åœ¨ s ä¸­ï¼Œè¿”å› true
func ContainsAny(s, chars string) bool
```

è¿™é‡Œå¯¹ ContainsAny å‡½æ•°è¿›è¡Œä¸€ä¸‹è¯´æ˜ï¼Œçœ‹å¦‚ä¸‹ä¾‹å­ï¼š

```go
var str string = "innoweb.comæˆ‘"
fmt.Println(strings.Contains(str,"inno"))
fmt.Println(strings.Contains(str,"l n"))
```

```go
fmt.Println(strings.ContainsAny("team", "i"))			//åšé˜¿å¯’i
fmt.Println(strings.ContainsAny("failure", "u & i"))	//åŒ…å«uæˆ–è€…i
fmt.Println(strings.ContainsAny("in failure", "s g"))	//åŒ…å«sæˆ–è€… æˆ–è€…g
fmt.Println(strings.ContainsAny("foo", ""))			
fmt.Println(strings.ContainsAny("", ""))
```

è¾“å‡ºï¼š

```go
true
false
```

```bash
false
true
true
false
false
```



### å­—ç¬¦ä¸²æ¯”è¾ƒCompareğŸ‘°

>  Compare å‡½æ•°ï¼Œç”¨äºæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„å¤§å°:
>
> å¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰ï¼Œè¿”å›ä¸º 0ã€‚å¦‚æœ a å°äº b ï¼Œè¿”å› -1 ï¼Œåä¹‹è¿”å› 1 ã€‚ä¸æ¨èä½¿ç”¨è¿™ä¸ªå‡½æ•°ï¼Œç›´æ¥ä½¿ç”¨ == != > < >= <= ç­‰ä¸€ç³»åˆ—è¿ç®—ç¬¦æ›´åŠ ç›´è§‚ã€‚

```go
func Compare(a, b string) int 
//   EqualFold å‡½æ•°ï¼Œè®¡ç®— s ä¸ t å¿½ç•¥å­—æ¯å¤§å°å†™åæ˜¯å¦ç›¸ç­‰ã€‚
func EqualFold(s, t string) bool
```

```go
fmt.Println(strings.Compare(str,str2))
// Compare å‡½æ•°ï¼Œç”¨äºæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„å¤§å°ï¼Œå¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰ï¼Œè¿”å›ä¸º 0ã€‚å¦‚æœ a å°äº b ï¼Œè¿”å› -1 ï¼Œåä¹‹è¿”å› 1 ã€‚
fmt.Println(strings.EqualFold("GO", "go"))
// EqualFold å‡½æ•°ï¼Œè®¡ç®— s ä¸ t å¿½ç•¥å­—æ¯å¤§å°å†™åæ˜¯å¦ç›¸ç­‰ã€‚
```



###  å­ä¸²å‡ºç°æ¬¡æ•° CountğŸ‘©â€ğŸ­

åœ¨æ•°æ®ç»“æ„ä¸ç®—æ³•ä¸­ï¼Œå¯èƒ½ä¼šè®²è§£ä»¥ä¸‹å­—ç¬¦ä¸²åŒ¹é…ç®—æ³•ï¼š

- æœ´ç´ åŒ¹é…ç®—æ³•
- KMP ç®—æ³•
- Rabin-Karp ç®—æ³•
- Boyer-Moore ç®—æ³•

è¿˜æœ‰å…¶ä»–çš„ç®—æ³•ï¼Œè¿™é‡Œä¸ä¸€ä¸€åˆ—ä¸¾ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥ç½‘ä¸Šæœä¸€ä¸‹ã€‚

åœ¨ Go ä¸­ï¼ŒæŸ¥æ‰¾å­ä¸²å‡ºç°æ¬¡æ•°å³å­—ç¬¦ä¸²æ¨¡å¼åŒ¹é…ï¼Œå®ç°çš„æ˜¯ Rabin-Karp ç®—æ³•ã€‚Count å‡½æ•°çš„ç­¾åå¦‚ä¸‹ï¼š

```go
func Count(s, sep string) int
```

åœ¨ Count çš„å®ç°ä¸­ï¼Œå¤„ç†äº†å‡ ç§ç‰¹æ®Šæƒ…å†µï¼Œå±äºå­—ç¬¦åŒ¹é…é¢„å¤„ç†çš„ä¸€éƒ¨åˆ†ã€‚è¿™é‡Œè¦ç‰¹åˆ«è¯´æ˜ä¸€ä¸‹çš„æ˜¯å½“ sep ä¸ºç©ºæ—¶ï¼ŒCount çš„è¿”å›å€¼æ˜¯ï¼šutf8.RuneCountInString(s) + 1

```go
fmt.Println(strings.Count("cheeseeee", "ee"))
fmt.Println(strings.Count("fivevev", "vev"))
// Count æ˜¯è®¡ç®—å­ä¸²åœ¨å­—ç¬¦ä¸²ä¸­å‡ºç°çš„æ— é‡å çš„æ¬¡æ•°
```

è¾“å‡ºï¼š

```bash
3
1
```



### å­—ç¬¦ä¸²é‡å¤å‡ æ¬¡ç”ŸæˆRepeatğŸ‘¨â€âš–ï¸

å‡½æ•°ç­¾åå¦‚ä¸‹ï¼š

```go
func Repeat(s string, count int) string
```

å°† s é‡å¤ count æ¬¡ï¼Œå¦‚æœ count ä¸ºè´Ÿæ•°æˆ–è¿”å›å€¼é•¿åº¦ len(s)*count è¶…å‡º string ä¸Šé™ä¼šå¯¼è‡´ panicï¼Œè¿™ä¸ªå‡½æ•°ä½¿ç”¨å¾ˆç®€å•ï¼š

```go
fmt.Println("ba" + strings.Repeat("na", 2))
```

è¾“å‡ºç»“æœï¼š

```bash
banana
```



### å­—ç¬¦ä¸²åˆ‡å‰²Split å’Œ SplitAfterğŸ§™â€â™‚ï¸

è¿™å››ä¸ªå‡½æ•°éƒ½æ˜¯é€šè¿‡ **sep** è¿›è¡Œåˆ†å‰²ï¼Œè¿”å›[]stringã€‚å¦‚æœ **sep** ä¸ºç©ºï¼Œç›¸å½“äº**åˆ†æˆä¸€ä¸ªä¸ªçš„ UTF-8 å­—ç¬¦**ï¼Œå¦‚ `Split("abc","")`ï¼Œå¾—åˆ°çš„æ˜¯**[a b c]**ã€‚

```go
func Split(s, sep string) []string 
func SplitAfter(s, sep string) []string 
```

é‚£ä¹ˆï¼ŒSplit å’Œ SplitAfter æœ‰å•¥åŒºåˆ«å‘¢ï¼Ÿé€šè¿‡è¿™ä¸¤å¥ä»£ç çš„ç»“æœå°±çŸ¥é“å®ƒä»¬çš„åŒºåˆ«äº†ï¼š

```go
fmt.Printf("%q\n", strings.Split("foo,bar,baz", ","))
fmt.Printf("%q\n", strings.SplitAfter("foo,bar,baz", ","))
```

è¾“å‡ºï¼š

```bash
["foo" "bar" "baz"]
["foo," "bar," "baz"]
```

ä¹Ÿå°±æ˜¯è¯´ï¼ŒSplit ä¼šå°† s ä¸­çš„ sep å»æ‰ï¼Œè€Œ SplitAfter ä¼šä¿ç•™ sepã€‚



### å­—ç¬¦ä¸²ç»„åˆ JOIN æ“ä½œğŸ‘¨â€ğŸ”¬

å°†å­—ç¬¦ä¸²æ•°ç»„ï¼ˆæˆ– sliceï¼‰è¿æ¥èµ·æ¥å¯ä»¥é€šè¿‡ Join å®ç°ï¼Œå‡½æ•°ç­¾åå¦‚ä¸‹ï¼š

```go
func Join(a []string, sep string) string
```

```go
fmt.Println(strings.Join(strings.Split("a,b,c,d,e",","),""))
//abcde
```



### å¤§å°å†™è½¬æ¢ToUpperğŸ§›â€â™‚ï¸

```go
func ToLower(s string) string
func ToUpper(s string) string
```

å¤§å°å†™è½¬æ¢åŒ…å«äº† 4 ä¸ªç›¸å…³å‡½æ•°ï¼ŒToLower,ToUpper ç”¨äºå¤§å°å†™è½¬æ¢ã€‚ToLowerSpecial,ToUpperSpecial å¯ä»¥è½¬æ¢ç‰¹æ®Šå­—ç¬¦çš„å¤§å°å†™ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š

```go
fmt.Println(strings.ToLower("HELLO WORLD"))
fmt.Println(strings.ToLower("Ä€ Ã Ç Ã€"))
fmt.Println(strings.ToLowerSpecial(unicode.TurkishCase, "å£¹"))
fmt.Println(strings.ToLowerSpecial(unicode.TurkishCase, "HELLO WORLD"))
fmt.Println(strings.ToLower("Ã–nnek Ä°ÅŸ"))
fmt.Println(strings.ToLowerSpecial(unicode.TurkishCase, "Ã–nnek Ä°ÅŸ"))

fmt.Println(strings.ToUpper("hello world"))
fmt.Println(strings.ToUpper("Ä Ã¡ Ç Ã "))
fmt.Println(strings.ToUpperSpecial(unicode.TurkishCase, "ä¸€"))
fmt.Println(strings.ToUpperSpecial(unicode.TurkishCase, "hello world"))
fmt.Println(strings.ToUpper("Ã¶rnek iÅŸ"))
fmt.Println(strings.ToUpperSpecial(unicode.TurkishCase, "Ã¶rnek iÅŸ"))
```

è¾“å‡ºç»“æœ:

```bash
hello world
Ä Ã¡ Ç Ã 
å£¹
hello world
Ã¶nnek iÅŸ
Ã¶nnek iÅŸ
HELLO WORLD
Ä€ Ã Ç Ã€       // æ±‰å­—æ‹¼éŸ³æœ‰æ•ˆ
ä¸€           //  æ±‰å­—æ— æ•ˆ
HELLO WORLD
Ã–RNEK IÅ
Ã–RNEK Ä°Å    // æœ‰ç»†å¾®å·®åˆ«
```



### ä¿®å‰ªTrimğŸ‘¨â€ğŸ¤

```go
// å°† s å·¦ä¾§å’Œå³ä¾§ä¸­åŒ¹é… cutset ä¸­çš„ä»»ä¸€å­—ç¬¦çš„å­—ç¬¦å»æ‰
func Trim(s string, cutset string) string
// å°† s å·¦ä¾§çš„åŒ¹é… cutset ä¸­çš„ä»»ä¸€å­—ç¬¦çš„å­—ç¬¦å»æ‰
func TrimLeft(s string, cutset string) string
// å°† s å³ä¾§çš„åŒ¹é… cutset ä¸­çš„ä»»ä¸€å­—ç¬¦çš„å­—ç¬¦å»æ‰
func TrimRight(s string, cutset string) string
// å¦‚æœ s çš„å‰ç¼€ä¸º prefix åˆ™è¿”å›å»æ‰å‰ç¼€åçš„ string , å¦åˆ™ s æ²¡æœ‰å˜åŒ–ã€‚
func TrimPrefix(s, prefix string) string
// å¦‚æœ s çš„åç¼€ä¸º suffix åˆ™è¿”å›å»æ‰åç¼€åçš„ string , å¦åˆ™ s æ²¡æœ‰å˜åŒ–ã€‚
```

åŒ…å«äº† 9 ä¸ªç›¸å…³å‡½æ•°ç”¨äºä¿®å‰ªå­—ç¬¦ä¸²ã€‚

> ä¸¾ä¸ªä¾‹å­ï¼š

```go
var a string = "!!@@$$  "
fmt.Println(strings.Trim(a,"! "))
//@@$$
var a string = "!!@@$$  "
fmt.Println(strings.Trim(a,"! "))
fmt.Println(strings.TrimLeft(a,"!@"))
fmt.Println(strings.TrimRight(a,"$"))
fmt.Println(strings.TrimPrefix(a,"$$"))
//@@$$
//$$  
//!!@@$$ç©ºæ ¼ç©ºæ ¼
//!!@@$$ç©ºæ ¼ç©ºæ ¼  
```



### å­—ç¬¦ä¸²æ˜¯å¦æœ‰æŸä¸ªå‰ç¼€æˆ–åç¼€ğŸ§œâ€â™‚ï¸

è¿™ä¸¤ä¸ªå‡½æ•°æ¯”è¾ƒç®€å•ï¼Œæºç å¦‚ä¸‹ï¼š

```go
// s ä¸­æ˜¯å¦ä»¥ prefix å¼€å§‹
func HasPrefix(s, prefix string) bool {
  return len(s) >= len(prefix) && s[0:len(prefix)] == prefix
}
// s ä¸­æ˜¯å¦ä»¥ suffix ç»“å°¾
func HasSuffix(s, suffix string) bool {
  return len(s) >= len(suffix) && s[len(s)-len(suffix):] == suffix
}
```

å¦‚æœ prefix æˆ– suffix ä¸º "" , è¿”å›å€¼æ€»æ˜¯ trueã€‚

ç¤ºä¾‹ï¼š

```go
fmt.Println(strings.HasPrefix("Gopher", "Go"))
fmt.Println(strings.HasPrefix("Gopher", "C"))
fmt.Println(strings.HasPrefix("Gopher", ""))
fmt.Println(strings.HasSuffix("Amigo", "go"))
fmt.Println(strings.HasSuffix("Amigo", "Ami"))
fmt.Println(strings.HasSuffix("Amigo", ""))
```

è¾“å‡ºç»“æœï¼š

```bash
true
false
true
true
false
true
```



### å­ä¸²åœ¨å­—ç¬¦ä¸²ä¸­å‡ºç°çš„ä½ç½®IndexğŸ’‚â€â™‚ï¸

æœ‰ä¸€åºåˆ—å‡½æ•°ä¸è¯¥åŠŸèƒ½æœ‰å…³ï¼š

```go
// åœ¨ s ä¸­æŸ¥æ‰¾ sep çš„ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œè¿”å›ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•
func Index(s, sep string) int
// åœ¨ s ä¸­æŸ¥æ‰¾å­—èŠ‚ c çš„ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œè¿”å›ç¬¬ä¸€æ¬¡å‡ºç°çš„ç´¢å¼•
func IndexByte(s string, c byte) int
// chars ä¸­ä»»ä½•ä¸€ä¸ª Unicode ä»£ç ç‚¹åœ¨ s ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®
func IndexAny(s, chars string) int
// æŸ¥æ‰¾å­—ç¬¦ c åœ¨ s ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå…¶ä¸­ c æ»¡è¶³ f(c) è¿”å› true
func IndexFunc(s string, f func(rune) bool) int
// Unicode ä»£ç ç‚¹ r åœ¨ s ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®
func IndexRune(s string, r rune) int

// æœ‰ä¸‰ä¸ªå¯¹åº”çš„æŸ¥æ‰¾æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½®
func LastIndex(s, sep string) int
func LastIndexByte(s string, c byte) int
func LastIndexAny(s, chars string) int
func LastIndexFunc(s string, f func(rune) bool) int
```

åœ¨ 2.1.1 å°èŠ‚æåˆ°è¿‡ï¼ŒContain ç›¸å…³çš„å‡½æ•°å†…éƒ¨è°ƒç”¨çš„æ˜¯å“åº”çš„ Index å‡½æ•°ã€‚

è¿™ä¸€åºåˆ—å‡½æ•°ï¼Œåªä¸¾ IndexFunc çš„ä¾‹å­ï¼š

```go
han := func(c rune) bool {
    return unicode.Is(unicode.Han, c) // æ±‰å­—
}
fmt.Println(strings.IndexFunc("Hello, world", han))
fmt.Println(strings.IndexFunc("Hello, ä¸–ç•Œ", han))
```

è¾“å‡ºï¼š

```bash
-1
7
```



## stringsåŒ…çš„Readeræ¥å£ğŸ‘©â€ğŸš’

è§£è¯»ä¹‹å‰å…ˆæ¥ç†è§£ä¸€ä¸‹readeræ¥å£å’Œwriteræ¥å£ï¼Œæƒ³è±¡ä¸€ä¸‹è¯»å’Œå†™çš„è¿‡ç¨‹ã€‚

```go
type Reader interface {
	Read(p []byte) (n int, err error)
}
```

> å¯ä»¥çœ‹åˆ°è¿™ä¸ª**Read**å‡½æ•°æ¥å—ä¸€ä¸ªå­—èŠ‚æ•°ç»„ï¼Œè¿”å›ä¸€ä¸ª**int n**å’Œ**err**ï¼Œ**int n**è¿”å›çš„æ—¶è¯»å–å­—èŠ‚æ•°ï¼Œ**err**è¿”å›çš„ä¸€èˆ¬æ˜¯**EOFï¼ˆEND-OF-FILEï¼‰**æˆ–è€…æ˜¯**NIL**ï¼Œå½“æˆ‘ä»¬æ²¡å®Œå…¨è¯»å®Œæ–‡ä»¶æ—¶è¿”å›çš„å°±æ˜¯**NIL**ï¼Œå¦åˆ™å°±æ˜¯**EOF**ã€‚è¯»å‡ºæ¥çš„å­—ç¬¦ä¼šç›´æ¥è¯»åˆ°å­—èŠ‚æ•°ç»„**p**ä¸­ï¼Œå› ä¸ºæ˜¯åˆ‡ç‰‡æ•°ç»„æ‰€ä»¥ä¼šå¯¹åŸæ•°ç»„å†…å®¹é€ æˆå½±å“ï¼Œä¸éœ€è¦è¿”å›å¹¶ä¸”æ¥å—ã€‚

æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªå‡½æ•°ï¼Œå…¶åŠŸèƒ½å¤§æ¦‚æ˜¯å¯¹æ•°ç»„è¿›è¡Œè¾“å…¥ï¼Œå¹¶ä¸”æ ¹æ®nåˆ¤æ–­æ˜¯å¦è¯»åˆ°äº†å€¼è¿”å›å­—èŠ‚æ•°ç»„ã€‚

```go
func ReadFrom(reader io.Reader, num int) ([]byte, error) {
	p := make([]byte, num)
	n, err := reader.Read(p)
	fmt.Println(n)
	if n > 0 {
		return p[:n], nil
	}
	return p, err
}
```

æˆ‘ä»¬è°ƒç”¨stringsä¸‹çš„NewReaderæ–¹æ³•è¿”å›ä¸€ä¸ªç¬¦åˆio.Readerçš„ç»“æ„ä½“ï¼Œç„¶åæˆ‘ä»¬å¯¹å…¶è¿›è¡Œä¸‰æ¬¡è¯»å–ã€‚

```go
func main(){
	s := strings.NewReader("123")
	data1, err := ReadFrom(s,1)
	data2, err := ReadFrom(s,2)
	data3, err := ReadFrom(s,3)
	fmt.Println(data1,err)
	fmt.Println(data2,err)
	fmt.Println(data3,err)
}
```

åˆ†æè¯»å–ç»“æœï¼Œæˆ‘ä»¬å‘ç°è¯»å–æ˜¯è®°å½•çŠ¶æ€çš„ï¼Œè¯»ä¸åˆ°ä¸œè¥¿çš„æ—¶å€™è¿”å›äº†endOfFileã€‚

```go
1 <nil>
2 <nil>
0 EOF
[49] EOF
[50 51] EOF
[0 0 0] EOF
```

é‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹**strings.NewReader("123")**è¿”å›äº†æ€ä¹ˆæ ·çš„ä¸€ä¸ªå®ç°è€…ã€‚

```go
func NewReader(s string) *Reader { return &Reader{s, 0, -1} }
type Reader struct {
	s        string
	i        int64 // current reading index
	prevRune int   // index of previous rune; or < 0
}
```

> è¿™é‡Œé¢string sè®°å½•å®é™…çš„å†…å®¹ï¼Œiè¡¨ç¤ºå·²ç»è¯»åˆ°çš„ä½ç½®ï¼ŒprevRuneè¡¨ç¤ºä¸Šä¸€ä¸ªã€‚

### ReadğŸ‘¼

æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹ä»–çš„readæ–¹æ³•

```go
func (r *Reader) Read(b []byte) (n int, err error) {
	if r.i >= int64(len(r.s)) {
		return 0, io.EOF
	}
	r.prevRune = -1
	n = copy(b, r.s[r.i:])
	r.i += int64(n)
	return
}
```

> å¦‚æœè¯´**r.i >= int64(len(r.s)ï¼‰**é‚£ä¹ˆå­—ç¬¦ä¸²å·²ç»è¢«è¯»å®Œäº†ï¼Œè¿”å›**EOF**ï¼Œå¦åˆ™æ‹·è´å­—ç¬¦ä¸²å†…å®¹åˆ°btyeæ•°ç»„ä¸­ï¼Œç„¶ååç§»r.iæ‹·è´æ•°ç»„çš„é•¿åº¦ï¼Œè¿”å›å®é™…è¯»å–å­—ç¬¦ä¸²çš„é•¿åº¦å’Œnilï¼ˆæ²¡æœ‰è¯»å–é”™è¯¯ï¼‰ã€‚è¿™å°±æ˜¯ä¸€ä¸ªreadçš„è¿‡ç¨‹ã€‚

### ReadAtğŸ§”

ç„¶åå†çœ‹çœ‹ReadAtæ–¹æ³•

```go
func (r *Reader) ReadAt(b []byte, off int64) (n int, err error) {
	if off < 0 {
		return 0, errors.New("strings.Reader.ReadAt: negative offset")
	}
	if off >= int64(len(r.s)) {
		return 0, io.EOF
	}
	n = copy(b, r.s[off:])
	if n < len(b) {
		err = io.EOF
	}
	return
}
```

> å…ˆåˆ¤æ–­åç§»é‡æ˜¯å¦è¶Šç•Œï¼Œç„¶åæ‹·è´æ•°ç»„ï¼Œå¦‚æœæ‹·è´æ²¡æœ‰å®é™…æ‹·è´æ•ˆæœå°±æŠ›å‡ºEOFï¼Œå¦åˆ™è¿”å›æ‹·è´å­—èŠ‚æ•°å’Œnullï¼Œè¿™ä¸ªå°±ä¸éœ€è¦è€ƒè™‘ä¸Šä¸€æ¬¡çš„è¯»å–ä½ç½®äº†ï¼Œæ¯ä¸€æ¬¡éƒ½æ˜¯éšæœºçš„ã€‚

