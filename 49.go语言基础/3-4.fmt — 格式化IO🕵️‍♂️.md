# fmt â€” æ ¼å¼åŒ–IOğŸ•µï¸â€â™‚ï¸

> fmt åŒ…å®ç°äº†æ ¼å¼åŒ–I/Oå‡½æ•°ï¼Œç±»ä¼¼äºCçš„ printf å’Œ scanf. æ ¼å¼â€œå ä½ç¬¦â€è¡ç”Ÿè‡ªCï¼Œä½†æ¯”Cæ›´ç®€å•ï¼ŒfmtåŒ…ä¸æ˜¯ç”¨æ¥å®ç°æ§åˆ¶å°è¾“å‡ºçš„é‡è¦çš„äº‹æƒ…è¯´100é

##### åˆ†ç±»

> - fmt.P$( )		//å°†æ•°æ®è¾“å‡ºåˆ°æ§åˆ¶å°
> - fmt.Fp$( )	  //å°†æ•°æ®è¾“å‡ºåˆ°**io.Write**æ¥å£çš„å®ç°è€…
> - fmt.Sp$( )	   //å°†æ•°æ®è¾“å‡ºåˆ°string()

##### åº•å±‚åŸç†

`æºç `

```go
type Writer interface {
	Write(p []byte) (n int, err error)
}
```

```go
func Fprint(w io.Writer, a ...interface{}) (n int, err error) {
	p := newPrinter()
	p.doPrint(a)
	n, err = w.Write(p.buf)
	p.free()
	return
}
```

å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è®²æ ¼å¼åŒ–å¥½çš„å­—èŠ‚æ•°ç»„è¾“å…¥åˆ°io.Writerä¸­ï¼Œå†ç”±io.Writerçš„å®ç°è€…æ¥å†™å…¥ï¼Œå¹³æ—¶æˆ‘ä»¬æ¯”è¾ƒå¸¸ç”¨çš„ç”±stdOutä¹Ÿå°±æ˜¯æ§åˆ¶å°çš„å†™å…¥å®ç°è€…ã€‚

`æºç `

```go
func Sprint(a ...interface{}) string {
	p := newPrinter()
	p.doPrint(a)
	s := string(p.buf)
	p.free()
	return s
}
```

å¯ä»¥çœ‹åˆ°è¿™é‡Œæˆ‘ä»¬å°†å‚æ•°ä¼ è¿›å»ä¹‹å**p := newPrinter()ï¼Œp.doPrint(a)**å°†å‚æ•°è½¬æ¢ä½å­—èŠ‚æ•°ç»„ï¼Œæœ€åç”±**string()**æ¥è½¬æ¢æˆstringç±»å‹è¿”å›ã€‚



## fmt.P$ğŸ‘¨â€âœˆï¸

På¼€å¤´çš„ä¸€èˆ¬æŒ‡æ§åˆ¶å°è¾“å‡º

> - fmt.Print( )	//å°†æ•°æ®è¾“å‡ºåˆ°æ§åˆ¶å°
> - fmt.Printf( )   //å°†æ•°æ®æ ¼å¼åŒ–å¹¶ä¸”è¾“å‡ºåˆ°æ§åˆ¶å°ã€‚
> - fmt.Println( ) //å°†æ•°æ®è¾“å‡ºåˆ°æ§åˆ¶å°å¹¶ä¸”æ¢è¡Œã€‚

##### åº•å±‚åŸç†

`æºç `

```go
func Print(a ...interface{}) (n int, err error) {
	return Fprint(os.Stdout, a...)
}
```

å¯ä»¥çœ‹åˆ°Printå‡½æ•°å°†æ•°æ®é€šè¿‡Fprintè½¬æ¢æˆbyteæ•°ç»„è¾“å…¥åˆ°io.Stdoutä¸­ï¼ŒStdoutçš„writeæ–¹æ³•è´Ÿè´£è®²å­—èŠ‚æ•°ç»„æ ‡å‡†å†™å…¥åˆ°æ§åˆ¶å°ä¸­ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬å¹³æ—¶ä½¿ç”¨çš„æ§åˆ¶å°è¾“å‡ºçš„åŸºæœ¬å®ç°åŸç†ã€‚

### fmt.Printfæ ¼å¼åŒ–è¾“å‡ºğŸ§”

##### å ä½ç¬¦

```go
func main(){
	fmt.Printf("%%")
	fmt.Println()
	fmt.Println("å•çº¯çš„è¾“å‡ºç™¾åˆ†å·")

	fmt.Printf("%t",true)
	fmt.Println()
	fmt.Println("å•çº¯çš„è¾“å‡ºçœŸå‡å€¼ï¼ˆtrue/falseï¼‰")

	fmt.Printf("%v","string")
	fmt.Println()
	fmt.Println("åŸæ ¼å¼è¾“å‡º")
	fmt.Printf("%T","string")
	fmt.Println()
	fmt.Println("æ‰“å°æ•°æ®ç±»å‹")

	fmt.Printf("%d",12)
	fmt.Println()
	fmt.Println("åè¿›åˆ¶æ–¹æ³•è¡¨ç¤ºï¼Œåªèƒ½ä¼ é€’int")
	fmt.Printf("%b",12)
	fmt.Println()
	fmt.Println("äºŒè¿›åˆ¶æ–¹æ³•è¡¨ç¤ºï¼Œåªèƒ½ä¼ é€’int")

	fmt.Printf("%q","string")
	fmt.Println()
	fmt.Println("åŒå¼•å·å›´ç»•çš„å­—ç¬¦ä¸²ï¼Œç”±Goè¯­æ³•å®‰å…¨åœ°è½¬ä¹‰")

	fmt.Printf("%s", []byte("Goè¯­è¨€ä¸­æ–‡ç½‘"))
	fmt.Println()
	fmt.Println("è¾“å‡ºå­—ç¬¦ä¸²è¡¨ç¤ºï¼ˆstringç±»å‹æˆ–[]byte)")

	fmt.Printf("%c", 0x4E2D)
	fmt.Println()
	fmt.Println("ç›¸åº”Unicodeç ç‚¹æ‰€è¡¨ç¤ºçš„å­—ç¬¦")
}
```

##### æ ¼å¼åŒ–é”™è¯¯

å¦‚æœç»™å ä½ç¬¦æä¾›äº†æ— æ•ˆçš„å®å‚ï¼ˆä¾‹å¦‚å°†ä¸€ä¸ªå­—ç¬¦ä¸²æä¾›ç»™ %dï¼‰ï¼Œæ‰€ç”Ÿæˆçš„å­—ç¬¦ä¸²ä¼šåŒ…å«è¯¥é—®é¢˜çš„æè¿°ï¼Œå¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š

```bash
    ç±»å‹é”™è¯¯æˆ–å ä½ç¬¦æœªçŸ¥ï¼š%!verb(type=value)
        Printf("%d", hi):          %!d(string=hi)
    å®å‚å¤ªå¤šï¼š%!(EXTRA type=value)
        Printf("hi", "guys"):      hi%!(EXTRA string=guys)
    å®å‚å¤ªå°‘ï¼š %!verb(MISSING)
        Printf("hi%d"):            hi %!d(MISSING)
    å®½åº¦æˆ–ç²¾åº¦ä¸æ˜¯intç±»å‹: %!(BADWIDTH) æˆ– %!(BADPREC)
        Printf("%*s", 4.5, "hi"):  %!(BADWIDTH)hi
        Printf("%.*s", 4.5, "hi"): %!(BADPREC)hi
    æ‰€æœ‰é”™è¯¯éƒ½å§‹äºâ€œ%!â€ï¼Œæœ‰æ—¶ç´§è·Ÿç€å•ä¸ªå­—ç¬¦ï¼ˆå ä½ç¬¦ï¼‰ï¼Œå¹¶ä»¥å°æ‹¬å·æ‹¬ä½çš„æè¿°ç»“å°¾ã€‚
```



## fmt.Sp$ğŸ‘¨â€ğŸ¨

Spå¼€å¤´çš„ä¸€èˆ¬æŒ‡æ§åˆ¶å°è¾“å‡º

> - fmt.Sprint( )	//å°†æ•°æ®è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ã€‚
> - fmt.Sprintf( )   //å°†æ•°æ®æ ¼å¼åŒ–å¹¶ä¸”è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ã€‚
> - fmt.Sprintln( ) //å°†æ•°æ®è½¬åŒ–ä¸ºå­—ç¬¦ä¸²å¹¶ä¸”æ·»åŠ æ¢è¡Œã€‚

```go
package main

import "fmt"

type lion struct {
	age int
	name string
}

func (l lion) String() string {
	return fmt.Sprint("ç‹®å­åå«",l.name,"ï¼Œä»Šå¹´",l.age,"å²äº†ã€‚")
}

func main(){
    xb := lion{name:"xinba",age:7}
	fmt.Print(xb)
	fmt.Printf("%T",fmt.Sprint("ç‹®å­åå«","ï¼Œä»Šå¹´","å²äº†ã€‚"))
}
```

```go
ç‹®å­åå«xinbaï¼Œä»Šå¹´7å²äº†ã€‚
string
```



## fmt.Fp$ğŸ‘©â€ğŸ«

Spå¼€å¤´çš„ä¸€èˆ¬æŒ‡æ§åˆ¶å°è¾“å‡º

> - fmt.Fprint( )	//å°†æ•°æ®è¾“å‡ºåˆ°wtiteræ¥å£çš„å®ç°è€…ã€‚
> - fmt.Fprintf( )   //å°†æ•°æ®æ ¼å¼åŒ–å¹¶ä¸”è¾“å‡ºåˆ°wtiteræ¥å£çš„å®ç°è€…ã€‚
> - fmt.Fprintln( ) //å°†æ•°æ®è¾“å‡ºåˆ°wtiteræ¥å£çš„å®ç°è€…å¹¶ä¸”æ·»åŠ æ¢è¡Œã€‚

`æºç `

```go
type Writer interface {
	Write(p []byte) (n int, err error)
}
```

```go
func Fprint(w io.Writer, a ...interface{}) (n int, err error) {
	p := newPrinter()
	p.doPrint(a)
	n, err = w.Write(p.buf)
	p.free()
	return
}
```

å¯ä»¥çœ‹åˆ°æˆ‘ä»¬è®²æ ¼å¼åŒ–å¥½çš„å­—èŠ‚æ•°ç»„è¾“å…¥åˆ°io.Writerä¸­ï¼Œå†ç”±io.Writerçš„å®ç°è€…æ¥å†™å…¥ï¼Œå¹³æ—¶æˆ‘ä»¬æ¯”è¾ƒå¸¸ç”¨çš„ç”±stdOutä¹Ÿå°±æ˜¯æ§åˆ¶å°çš„å†™å…¥å®ç°è€…ã€‚



## è·å–è¾“å…¥ğŸŠ

Goè¯­è¨€`fmt`åŒ…ä¸‹æœ‰`fmt.Scan`ã€`fmt.Scanf`ã€`fmt.Scanln`ä¸‰ä¸ªå‡½æ•°ï¼Œå¯ä»¥åœ¨ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­ä»æ ‡å‡†è¾“å…¥è·å–ç”¨æˆ·çš„è¾“å…¥ã€‚

### fmt.Scan

å‡½æ•°å®šç­¾åå¦‚ä¸‹ï¼š

```go
func Scan(a ...interface{}) (n int, err error)
```

- Scanä»æ ‡å‡†è¾“å…¥æ‰«ææ–‡æœ¬ï¼Œè¯»å–ç”±ç©ºç™½ç¬¦åˆ†éš”çš„å€¼ä¿å­˜åˆ°ä¼ é€’ç»™æœ¬å‡½æ•°çš„å‚æ•°ä¸­ï¼Œæ¢è¡Œç¬¦è§†ä¸ºç©ºç™½ç¬¦ã€‚
- æœ¬å‡½æ•°è¿”å›æˆåŠŸæ‰«æçš„æ•°æ®ä¸ªæ•°å’Œé‡åˆ°çš„ä»»ä½•é”™è¯¯ã€‚å¦‚æœè¯»å–çš„æ•°æ®ä¸ªæ•°æ¯”æä¾›çš„å‚æ•°å°‘ï¼Œä¼šè¿”å›ä¸€ä¸ªé”™è¯¯æŠ¥å‘ŠåŸå› ã€‚

å…·ä½“ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š

```go
func main() {
	var (
		name    string
		age     int
		married bool
	)
	fmt.Scan(&name, &age, &married)
	fmt.Printf("æ‰«æç»“æœ name:%s age:%d married:%t \n", name, age, married)
}
```

å°†ä¸Šé¢çš„ä»£ç ç¼–è¯‘ååœ¨ç»ˆç«¯æ‰§è¡Œï¼Œåœ¨ç»ˆç«¯ä¾æ¬¡è¾“å…¥`å°ç‹å­`ã€`28`å’Œ`false`ä½¿ç”¨ç©ºæ ¼åˆ†éš”ã€‚

```bash
$ ./scan_demo 
å°ç‹å­ 28 false
æ‰«æç»“æœ name:å°ç‹å­ age:28 married:false 
```

`fmt.Scan`ä»æ ‡å‡†è¾“å…¥ä¸­æ‰«æç”¨æˆ·è¾“å…¥çš„æ•°æ®ï¼Œå°†ä»¥ç©ºç™½ç¬¦åˆ†éš”çš„æ•°æ®åˆ†åˆ«å­˜å…¥æŒ‡å®šçš„å‚æ•°ã€‚

### fmt.Scanf

å‡½æ•°ç­¾åå¦‚ä¸‹ï¼š

```go
func Scanf(format string, a ...interface{}) (n int, err error)
```

- Scanfä»æ ‡å‡†è¾“å…¥æ‰«ææ–‡æœ¬ï¼Œæ ¹æ®formatå‚æ•°æŒ‡å®šçš„æ ¼å¼å»è¯»å–ç”±ç©ºç™½ç¬¦åˆ†éš”çš„å€¼ä¿å­˜åˆ°ä¼ é€’ç»™æœ¬å‡½æ•°çš„å‚æ•°ä¸­ã€‚
- æœ¬å‡½æ•°è¿”å›æˆåŠŸæ‰«æçš„æ•°æ®ä¸ªæ•°å’Œé‡åˆ°çš„ä»»ä½•é”™è¯¯ã€‚

ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š

```go
func main() {
	var (
		name    string
		age     int
		married bool
	)
	fmt.Scanf("1:%s 2:%d 3:%t", &name, &age, &married)
	fmt.Printf("æ‰«æç»“æœ name:%s age:%d married:%t \n", name, age, married)
}
```

å°†ä¸Šé¢çš„ä»£ç ç¼–è¯‘ååœ¨ç»ˆç«¯æ‰§è¡Œï¼Œåœ¨ç»ˆç«¯æŒ‰ç…§æŒ‡å®šçš„æ ¼å¼ä¾æ¬¡è¾“å…¥`å°ç‹å­`ã€`28`å’Œ`false`ã€‚

```bash
$ ./scan_demo 
1:å°ç‹å­ 2:28 3:false
æ‰«æç»“æœ name:å°ç‹å­ age:28 married:false 
```

`fmt.Scanf`ä¸åŒäº`fmt.Scan`ç®€å•çš„ä»¥ç©ºæ ¼ä½œä¸ºè¾“å…¥æ•°æ®çš„åˆ†éš”ç¬¦ï¼Œ`fmt.Scanf`ä¸ºè¾“å…¥æ•°æ®æŒ‡å®šäº†å…·ä½“çš„è¾“å…¥å†…å®¹æ ¼å¼ï¼Œåªæœ‰æŒ‰ç…§æ ¼å¼è¾“å…¥æ•°æ®æ‰ä¼šè¢«æ‰«æå¹¶å­˜å…¥å¯¹åº”å˜é‡ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¿˜æ˜¯æŒ‰ç…§ä¸Šä¸ªç¤ºä¾‹ä¸­ä»¥ç©ºæ ¼åˆ†éš”çš„æ–¹å¼è¾“å…¥ï¼Œ`fmt.Scanf`å°±ä¸èƒ½æ­£ç¡®æ‰«æåˆ°è¾“å…¥çš„æ•°æ®ã€‚

```bash
$ ./scan_demo 
å°ç‹å­ 28 false
æ‰«æç»“æœ name: age:0 married:false 
```

### fmt.Scanln

å‡½æ•°ç­¾åå¦‚ä¸‹ï¼š

```go
func Scanln(a ...interface{}) (n int, err error)
```

- Scanlnç±»ä¼¼Scanï¼Œå®ƒåœ¨é‡åˆ°æ¢è¡Œæ—¶æ‰åœæ­¢æ‰«æã€‚æœ€åä¸€ä¸ªæ•°æ®åé¢å¿…é¡»æœ‰æ¢è¡Œæˆ–è€…åˆ°è¾¾ç»“æŸä½ç½®ã€‚
- æœ¬å‡½æ•°è¿”å›æˆåŠŸæ‰«æçš„æ•°æ®ä¸ªæ•°å’Œé‡åˆ°çš„ä»»ä½•é”™è¯¯ã€‚

å…·ä½“ä»£ç ç¤ºä¾‹å¦‚ä¸‹ï¼š

```go
func main() {
	var (
		name    string
		age     int
		married bool
	)
	fmt.Scanln(&name, &age, &married)
	fmt.Printf("æ‰«æç»“æœ name:%s age:%d married:%t \n", name, age, married)
}
```

å°†ä¸Šé¢çš„ä»£ç ç¼–è¯‘ååœ¨ç»ˆç«¯æ‰§è¡Œï¼Œåœ¨ç»ˆç«¯ä¾æ¬¡è¾“å…¥`å°ç‹å­`ã€`28`å’Œ`false`ä½¿ç”¨ç©ºæ ¼åˆ†éš”ã€‚

```bash
$ ./scan_demo 
å°ç‹å­ 28 false
æ‰«æç»“æœ name:å°ç‹å­ age:28 married:false 
```

`fmt.Scanln`é‡åˆ°å›è½¦å°±ç»“æŸæ‰«æäº†ï¼Œè¿™ä¸ªæ¯”è¾ƒå¸¸ç”¨ã€‚

### bufio.NewReader

æœ‰æ—¶å€™æˆ‘ä»¬æƒ³å®Œæ•´è·å–è¾“å…¥çš„å†…å®¹ï¼Œè€Œè¾“å…¥çš„å†…å®¹å¯èƒ½åŒ…å«ç©ºæ ¼ï¼Œè¿™ç§æƒ…å†µä¸‹å¯ä»¥ä½¿ç”¨`bufio`åŒ…æ¥å®ç°ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

```go
func bufioDemo() {
	reader := bufio.NewReader(os.Stdin) // ä»æ ‡å‡†è¾“å…¥ç”Ÿæˆè¯»å¯¹è±¡
	fmt.Print("è¯·è¾“å…¥å†…å®¹ï¼š")
	text, _ := reader.ReadString('\n') // è¯»åˆ°æ¢è¡Œ
	text = strings.TrimSpace(text)
	fmt.Printf("%#v\n", text)
}
```

### Fscanç³»åˆ—

è¿™å‡ ä¸ªå‡½æ•°åŠŸèƒ½åˆ†åˆ«ç±»ä¼¼äº`fmt.Scan`ã€`fmt.Scanf`ã€`fmt.Scanln`ä¸‰ä¸ªå‡½æ•°ï¼Œåªä¸è¿‡å®ƒä»¬ä¸æ˜¯ä»æ ‡å‡†è¾“å…¥ä¸­è¯»å–æ•°æ®è€Œæ˜¯ä»`io.Reader`ä¸­è¯»å–æ•°æ®ã€‚

```go
func Fscan(r io.Reader, a ...interface{}) (n int, err error)
func Fscanln(r io.Reader, a ...interface{}) (n int, err error)
func Fscanf(r io.Reader, format string, a ...interface{}) (n int, err error)
```

### Sscanç³»åˆ—

è¿™å‡ ä¸ªå‡½æ•°åŠŸèƒ½åˆ†åˆ«ç±»ä¼¼äº`fmt.Scan`ã€`fmt.Scanf`ã€`fmt.Scanln`ä¸‰ä¸ªå‡½æ•°ï¼Œåªä¸è¿‡å®ƒä»¬ä¸æ˜¯ä»æ ‡å‡†è¾“å…¥ä¸­è¯»å–æ•°æ®è€Œæ˜¯ä»æŒ‡å®šå­—ç¬¦ä¸²ä¸­è¯»å–æ•°æ®ã€‚

```go
func Sscan(str string, a ...interface{}) (n int, err error)
func Sscanln(str string, a ...interface{}) (n int, err error)
func Sscanf(str string, format string, a ...interface{}) (n int, err error)
```



## Stringer æ¥å£ğŸ

Stringeræ¥å£çš„å®šä¹‰å¦‚ä¸‹ï¼š

```go
    type Stringer interface {
        String() string
    }
```

æ ¹æ® Go è¯­è¨€ä¸­å®ç°æ¥å£çš„å®šä¹‰ï¼Œä¸€ä¸ªç±»å‹åªè¦æœ‰ `String() string` æ–¹æ³•ï¼Œæˆ‘ä»¬å°±è¯´å®ƒå®ç°äº† Stringer æ¥å£ã€‚è€Œåœ¨æœ¬èŠ‚å¼€å§‹å·²ç»è¯´åˆ°ï¼Œå¦‚æœæ ¼å¼åŒ–è¾“å‡ºæŸç§ç±»å‹çš„å€¼ï¼Œåªè¦å®ƒå®ç°äº† String() æ–¹æ³•ï¼Œé‚£ä¹ˆä¼šè°ƒç”¨ String() æ–¹æ³•è¿›è¡Œå¤„ç†ã€‚

```go
type lion struct {
	age int
	name string
}

func (l lion) String() string {
	return fmt.Sprint("ç‹®å­åå«",l.name,"ï¼Œä»Šå¹´",l.age,"å²äº†ã€‚")
}

func main(){
    xb := lion{name:"ç‹®å­ç‹",age:2}
	fmt.Print(xb)
	fmt.Printf("%T",fmt.Sprint("ç‹®å­åå«","ï¼Œä»Šå¹´","å²äº†ã€‚"))
}
```

```go
ç‹®å­åå«xinbaï¼Œä»Šå¹´7å²äº†ã€‚
string
```

